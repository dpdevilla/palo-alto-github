!function(){"use strict";customElements.get("shoppable-blog-component")||customElements.define("shoppable-blog-component",class extends HTMLElement{constructor(){super(),this.slider=this.querySelector("[data-slider]"),this.flkty=null,this.gutter=0,this.a11y=window.theme.a11y,this.checkSlidesSizeOnResize=()=>this.checkSlidesSize(),this.clickOutsideItemEvent=t=>this.clickOutsideItem(t)}connectedCallback(){this.bindButtons(),this.listen()}initSlider(){this.flkty=new window.theme.Flickity(this.slider,{prevNextButtons:!0,pageDots:!1,cellAlign:"left",wrapAround:!1,groupCells:!0,contain:!0,on:{ready:()=>{this.handleFocus()}}}),this.flkty.on("change",(()=>{const t=this.querySelectorAll("[data-item]");this.handleFocus(),t.length&&t.forEach((t=>{const e=t.querySelector("[data-item-products]");t.classList.remove("blog-item--active"),e&&t.querySelector("[data-item-products]").classList.remove("blog-item__products--visible")})),this.flkty&&!this.flkty.options.draggable&&(this.flkty.options.draggable=!0,this.flkty.updateDraggable())}))}destroySlider(){null!==this.flkty&&(this.flkty.destroy(),this.flkty=null)}checkSlidesSize(){const t=this.querySelector("[data-item]").currentStyle||window.getComputedStyle(this.querySelector("[data-item]"));this.gutter=parseInt(t.marginRight);const e=this.slider.offsetWidth+this.gutter<this.getItemsWidth();window.innerWidth>=theme.sizes.small&&e?this.initSlider():this.destroySlider()}clickOutsideItem(t){if(!(t.target.matches("[data-item]")||t.target.closest("[data-item]"))){this.querySelectorAll("[data-item]").forEach((t=>{const e=t.querySelector("[data-item-products]");e&&(e.classList.remove("blog-item__products--visible"),this.changeTabIndex(e),this.changeAriaHidden(e,!0)),t.classList.remove("blog-item--active")}))}}getItemsWidth(){let t=0;const e=this.slider.querySelectorAll("[data-item]");return e.length&&e.forEach((e=>{t+=e.offsetWidth+this.gutter})),t}bindButtons(){const t=this.querySelectorAll("[data-item-products-slider]"),e=this.querySelectorAll("[data-button-show]"),i=this.querySelectorAll("[data-button-hide]");e.length&&e.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),this.querySelectorAll("[data-item]").forEach((t=>{const e=t.querySelector("[data-item-products]");t.classList.remove("blog-item--active"),e&&(e.classList.remove("blog-item__products--visible"),this.changeTabIndex(e),this.changeAriaHidden(e,!0))}));const i=t.closest("[data-item]"),s=i.querySelector("[data-item-products]");if(i.classList.add("blog-item--active"),s){s.classList.add("blog-item__products--visible"),this.changeTabIndex(s,"enable"),this.changeAriaHidden(s,!1);const t=s.querySelector("[data-item-products-slider]"),e=t.querySelectorAll("[data-item-product]");t.classList.contains("flickity-enabled")&&e.forEach((t=>{const e=t.classList.contains("is-selected");t.setAttribute("tabindex",e?"0":"-1"),this.changeAriaHidden(t,!e)}))}null!==this.flkty&&(this.flkty.options.draggable=!1,this.flkty.updateDraggable()),this.a11y.state.trigger=t}))})),i.length&&i.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault();const i=t.closest("[data-item]"),s=i.querySelector("[data-item-products]");i.classList.remove("blog-item--active"),s&&(s.classList.remove("blog-item__products--visible"),this.changeTabIndex(s),this.changeAriaHidden(s,!0)),null!==this.flkty&&(this.flkty.options.draggable=!0,this.flkty.updateDraggable()),this.a11y.state.trigger.focus()}))})),t.length&&t.forEach((t=>{t.querySelectorAll("[data-item-product]").length>1&&new window.theme.Flickity(t,{prevNextButtons:!0,contain:!0,pageDots:!1,wrapAround:!0,on:{change:e=>{t.querySelectorAll("[data-item-product]").forEach(((t,i)=>{const s=i===e;t.setAttribute("tabindex",s?"0":"-1"),this.changeAriaHidden(t,!s)}))}}})})),this.slider.addEventListener("keyup",(t=>{if(t.code===theme.keyboardKeys.ESCAPE){const e=t.target.hasAttribute("data-slider")?t.target.querySelectorAll("[data-item]"):t.target.closest("[data-slider]").querySelectorAll("[data-item]");e.length&&(e.forEach((t=>{const e=t.querySelector("[data-item-products]");t.classList.remove("blog-item--active"),e&&(e.classList.remove("blog-item__products--visible"),this.changeTabIndex(e),this.changeAriaHidden(e,!0))})),this.flkty&&(this.flkty.options.draggable=!0,this.flkty.updateDraggable())),this.a11y.state.trigger.focus()}}))}handleFocus(){const t=this.querySelectorAll("[data-item]");t.length&&t.forEach((t=>{const e=t.classList.contains("is-selected"),i=t.querySelector("[data-item-products]");e?(this.changeTabIndex(t,"enable"),i&&this.changeTabIndex(i)):(this.changeTabIndex(t),i&&i.classList.remove("blog-item__products--visible"))}))}listen(){this.slider&&(this.checkSlidesSize(),document.addEventListener("theme:resize:width",this.checkSlidesSizeOnResize)),document.addEventListener("mousedown",this.clickOutsideItemEvent)}changeAriaHidden(t,e){t.setAttribute("aria-hidden",!!e)}changeTabIndex(t,e=""){const i="enable"===e?"0":"-1";t.querySelectorAll("a, button").forEach((t=>{t.setAttribute("tabindex",i)}));const s=t.querySelectorAll("[data-item-products-slider]"),a=t.querySelector("[data-item-products]"),l=t.classList.contains("blog-item__products--visible");s.forEach((t=>{t.setAttribute("tabindex",l?"0":"-1"),t.querySelectorAll("[data-item-product]").forEach((t=>{this.changeAriaHidden(t,!l)}))})),a&&this.changeAriaHidden(a,!l)}disconnectedCallback(){document.removeEventListener("theme:resize:width",this.checkSlidesSizeOnResize),document.removeEventListener("mousedown",this.clickOutsideItemEvent)}})}();
